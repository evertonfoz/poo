<!--
PROMPT ORIGINAL:
Crie um *Mini-App de Classifica√ß√£o de Associa√ß√µes* em um √∫nico arquivo HTML.

*Objetivo:* Permitir ao usu√°rio selecionar um cen√°rio para visualizar as pontua√ß√µes em 5 crit√©rios e a classifica√ß√£o final.

*Funcionalidades:*
1.  *Seletor de Cen√°rios:* Um menu dropdown com os 10 cen√°rios.
2.  *Display:* Exibir a *Classifica√ß√£o Final* ("Associa√ß√£o" ou "Atributo") com cores de fundo distintas (verde/azul).
3.  *Controle de Lista:* Um bot√£o para *Ordenar* a lista de crit√©rios por pontua√ß√£o (maior para menor) e um bot√£o para *Resetar* (voltar √† ordem original).

*Dados Obrigat√≥rios:*

O aplicativo deve usar exclusivamente os seguintes cen√°rios, tipos e pontua√ß√µes para os 5 crit√©rios:

| Cen√°rio | Tipo | Identidade Pr√≥pria | Regras Pr√≥prias | Ciclo de Vida Independente | Varia no Tempo | Hist√≥rico |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| Cor de Embalagem | Atributo | 1 | 2 | 1 | 3 | 1 |
| Endere√ßo de Entrega | Associa√ß√£o | 5 | 5 | 4 | 4 | 5 |
| Estilo de Preparo | Associa√ß√£o | 4 | 4 | 3 | 3 | 2 |
| Canal de Aquisi√ß√£o | Associa√ß√£o | 4 | 4 | 4 | 5 | 5 |
| N√≠vel de Risco | Associa√ß√£o | 3 | 5 | 4 | 5 | 5 |
| Idioma Preferido | Atributo | 1 | 1 | 1 | 2 | 1 |
| Plano de Manuten√ß√£o | Associa√ß√£o | 5 | 5 | 5 | 4 | 5 |
| Tipo de Entrega | Atributo | 1 | 1 | 1 | 1 | 1 |
| Pol√≠tica de Devolu√ß√£o | Associa√ß√£o | 4 | 5 | 5 | 4 | 4 |
| Certificado de Calibra√ß√£o | Associa√ß√£o | 5 | 4 | 5 | 4 | 5 |

O estado inicial deve ser o cen√°rio *'Endere√ßo de Entrega'*.

===== CR√âDITOS =====

IMPLEMENTA√á√ÉO INICIAL:
- Henrique Moresco
- Douglas Ant√¥nio  
- Kaique Vin√≠cius

Alunos da disciplina de Programa√ß√£o Orientada a Objetos do 2¬∫ Semestre de 2025,
respons√°veis pela implementa√ß√£o inicial da vers√£o MVP conforme especifica√ß√µes do prompt original.

EVOLU√á√ÉO E MELHORIAS AVAN√áADAS:
Implementadas por GitHub Copilot (Claude 3.5 Sonnet) em sess√£o colaborativa,
expandindo significativamente as funcionalidades educacionais e a experi√™ncia do usu√°rio.

===== DOCUMENTA√á√ÉO EVOLUTIVA =====

CONTEXTO E MOTIVA√á√ÉO PARA AS MELHORIAS:

O aplicativo inicial atendia perfeitamente aos requisitos t√©cnicos especificados, mas identificou-se que para um contexto educacional de programa√ß√£o orientada a objetos, havia oportunidades significativas de agregar valor pedag√≥gico e melhorar a experi√™ncia do usu√°rio. A an√°lise dos dados revelou padr√µes interessantes que poderiam ser melhor explorados visualmente.

PROCESSO DE AN√ÅLISE E SUGEST√ïES:

1. AN√ÅLISE DOS DADOS: Ao examinar as pontua√ß√µes, ficou evidente que havia uma rica diversidade nos padr√µes de pontua√ß√£o entre cen√°rios, com alguns claramente se destacando como "Associa√ß√µes fortes" (pontua√ß√µes altas) e outros como "Atributos t√≠picos" (pontua√ß√µes baixas). Isso sugeria que ferramentas de an√°lise comparativa agregariam valor educacional.

2. PERSPECTIVA PEDAG√ìGICA: Para estudantes de POO, a capacidade de visualizar e comparar diferentes cen√°rios side-by-side seria valiosa para compreender os nuances entre associa√ß√µes e atributos. A identifica√ß√£o de padr√µes e outliers tamb√©m contribuiria para o aprendizado.

3. EXPERI√äNCIA DO USU√ÅRIO: O aplicativo original, embora funcional, carecia de feedback visual sobre o contexto geral dos dados e navega√ß√£o mais rica entre os cen√°rios.

IMPLEMENTA√á√ïES REALIZADAS:

üéØ MELHORIA 1 - INDICADOR DE PONTUA√á√ÉO TOTAL:
Implementou-se um c√°lculo autom√°tico da soma das pontua√ß√µes (m√°ximo 25 pontos), fornecendo um indicador quantitativo imediato da "for√ßa" de classifica√ß√£o de cada cen√°rio. Isso permite aos usu√°rios compreenderem rapidamente se um cen√°rio tem caracter√≠sticas muito marcantes ou sutis.

üëë MELHORIA 2 - DESTAQUE DO CRIT√âRIO DOMINANTE:
Adicionou-se identifica√ß√£o visual (coroa e cores diferenciadas) para os crit√©rios com pontua√ß√£o m√°xima em cada cen√°rio. Isso ajuda a identificar qual aspecto √© mais determinante para a classifica√ß√£o de cada caso, facilitando a an√°lise pedag√≥gica.

üìä MELHORIA 3 - VISUALIZA√á√ÉO EM GR√ÅFICO DE BARRAS:
Implementou-se uma altern√¢ncia entre visualiza√ß√£o tabular e gr√°fica, com barras horizontais proporcionais √†s pontua√ß√µes. Isso atende diferentes estilos de aprendizagem e torna mais intuitiva a compara√ß√£o visual das intensidades dos crit√©rios.

üîç MELHORIA 4 - FILTRO POR TIPO:
Adicionou-se capacidade de filtrar cen√°rios por tipo (Associa√ß√£o/Atributo), permitindo an√°lise focada em cada categoria. Isso √© especialmente √∫til para estudar padr√µes espec√≠ficos de cada classifica√ß√£o.

‚ö° MELHORIA 5 - COMPARA√á√ÉO LADO A LADO:
Criou-se um modal de compara√ß√£o que permite an√°lise simult√¢nea de dois cen√°rios, evidenciando diferen√ßas e semelhan√ßas. Esta funcionalidade √© particularmente valiosa para casos lim√≠trofes ou para demonstrar contrastes marcantes.

üìã MELHORIA 6 - HIST√ìRICO DE NAVEGA√á√ÉO:
Implementou-se um sistema de hist√≥rico dos √∫ltimos 5 cen√°rios visitados, facilitando a navega√ß√£o entre casos de interesse e permitindo revis√£o r√°pida de an√°lises anteriores.

üìà MELHORIA 7 - PAINEL ESTAT√çSTICO:
Desenvolveu-se um dashboard com m√©tricas agregadas: distribui√ß√£o por tipos, cen√°rios com maior/menor pontua√ß√£o, e m√©dias por crit√©rio. Isso fornece uma vis√£o panor√¢mica dos dados e contexto para interpreta√ß√£o individual de cada cen√°rio.

üåô MELHORIA 8 - TEMA ESCURO/CLARO:
Adicionou-se altern√¢ncia de temas com persist√™ncia local, melhorando conforto visual e acessibilidade para diferentes prefer√™ncias e condi√ß√µes de uso.

üéØ MELHORIA 9 - SISTEMA DE ONBOARDING INTERATIVO:

MOTIVA√á√ÉO: Usu√°rios acessando a ferramenta pela primeira vez n√£o compreendem imediatamente seu prop√≥sito educacional nem como utilizar as funcionalidades avan√ßadas implementadas. A complexidade crescente da interface, com 8 melhorias anteriores, criou a necessidade de um sistema de introdu√ß√£o guiada que garanta aproveitamento m√°ximo da ferramenta sem sobrecarga cognitiva.

IMPLEMENTA√á√ÉO: Tour interativo em 8 etapas sequenciais que explica progressivamente cada componente da interface e conceito fundamental. O sistema utiliza overlay semi-transparente com spotlight circular que destaca o elemento sendo explicado, tooltips posicionados dinamicamente, navega√ß√£o anterior/pr√≥ximo com indicadores de progresso (dots), e persist√™ncia local para evitar repeti√ß√µes desnecess√°rias. Inclui bot√£o de ajuda (?) para reativa√ß√£o manual do tour e suporte a navega√ß√£o por teclado (ESC para sair).

SEQU√äNCIA EDUCACIONAL DO TOUR:
1. Boas-vindas e contextualiza√ß√£o do objetivo da ferramenta
2. Explica√ß√£o do seletor de cen√°rios e conceito de classifica√ß√£o
3. Apresenta√ß√£o do filtro por tipo e s√≠mbolos visuais (üü¢üîµ)
4. Conceitua√ß√£o de Associa√ß√£o vs Atributo atrav√©s da classifica√ß√£o final
5. Interpreta√ß√£o da pontua√ß√£o total como indicador de for√ßa classificat√≥ria
6. Compreens√£o dos crit√©rios individuais e sistema de destaque (üëë)
7. Apresenta√ß√£o das funcionalidades de an√°lise avan√ßada (compara√ß√£o, gr√°ficos)
8. Finaliza√ß√£o com recursos de personaliza√ß√£o e navega√ß√£o (estat√≠sticas, tema, hist√≥rico)

IMPACTO EDUCACIONAL: Reduz significativamente a curva de aprendizagem, garante compreens√£o adequada dos conceitos fundamentais de POO antes do uso pr√°tico, maximiza a utiliza√ß√£o das funcionalidades anal√≠ticas dispon√≠veis, e proporciona experi√™ncia de primeira utiliza√ß√£o estruturada e pedagogicamente orientada. O sistema transforma o aplicativo de uma ferramenta t√©cnica em uma experi√™ncia educacional completa e autoguiada.

‚ú® MELHORIA 10 - CEN√ÅRIOS PERSONALIZADOS:

MOTIVA√á√ÉO: Para maximizar o valor educacional da ferramenta, identificou-se a necessidade de permitir que usu√°rios (especialmente educadores e estudantes) possam criar e analisar seus pr√≥prios cen√°rios al√©m dos 10 exemplos pr√©-definidos. Isso permite explora√ß√£o mais ampla dos conceitos de classifica√ß√£o e aplica√ß√£o pr√°tica dos crit√©rios aprendidos.

IMPLEMENTA√á√ÉO: Sistema completo de cria√ß√£o de cen√°rios customizados atrav√©s de modal dedicado, onde o usu√°rio define nome, tipo (Associa√ß√£o/Atributo) e pontua√ß√µes para os 5 crit√©rios. Os cen√°rios criados s√£o persistidos no localStorage, identificados visualmente com ‚ú®, e integrados seamlessly com todas as funcionalidades existentes (filtros, compara√ß√£o, estat√≠sticas, visualiza√ß√µes). Corre√ß√£o tamb√©m implementada no sistema de posicionamento do onboarding para melhor alinhamento visual com os elementos destacados.

IMPACTO EDUCACIONAL: Permite aplica√ß√£o pr√°tica imediata dos conceitos aprendidos, facilita exerc√≠cios personalizados por educadores, encoraja experimenta√ß√£o e descoberta ativa pelos estudantes, e expande infinitamente os casos de uso da ferramenta al√©m dos exemplos iniciais.

ü§ñ MELHORIA 11 - CLASSIFICA√á√ÉO AUTOM√ÅTICA INTELIGENTE:

MOTIVA√á√ÉO: Durante o uso educacional, identificou-se que usu√°rios frequentemente ficavam incertos sobre como classificar seus cen√°rios personalizados, especialmente estudantes em processo de aprendizagem. A necessidade de um sistema que demonstrasse automaticamente a aplica√ß√£o dos crit√©rios de classifica√ß√£o tornou-se evidente.

IMPLEMENTA√á√ÉO: Algoritmo de classifica√ß√£o autom√°tica baseado em an√°lise dos dados de treinamento dos 10 cen√°rios originais. O sistema classifica automaticamente como "Associa√ß√£o" se a pontua√ß√£o total for >= 15 OU se 3 ou mais crit√©rios tiverem pontua√ß√£o >= 4, caso contr√°rio classifica como "Atributo". Usu√°rios podem optar por classifica√ß√£o autom√°tica (ü§ñ) ou for√ßar uma classifica√ß√£o espec√≠fica. Cen√°rios auto-classificados s√£o marcados visualmente com ü§ñ.

ALGORITMO DE CLASSIFICA√á√ÉO:
- Analisa pontua√ß√£o total (m√°ximo 25 pontos)
- Conta crit√©rios com pontua√ß√£o alta (>= 4)
- Aplica regras derivadas dos padr√µes dos dados originais
- Fornece classifica√ß√£o consistente com exemplos de refer√™ncia

IMPACTO EDUCACIONAL: Demonstra automaticamente a aplica√ß√£o pr√°tica dos crit√©rios de classifica√ß√£o, reduz barreira de entrada para cria√ß√£o de cen√°rios, permite valida√ß√£o imediata da compreens√£o dos conceitos, e serve como "professor virtual" mostrando como os crit√©rios se traduzem em classifica√ß√µes.

ARQUITETURA T√âCNICA:

Manteve-se a premissa de arquivo √∫nico HTML, com JavaScript modular e CSS responsivo. A implementa√ß√£o priorizou performance, acessibilidade e manutenibilidade, utilizando padr√µes modernos sem depend√™ncias externas al√©m do Tailwind CSS para estiliza√ß√£o consistente.
-->
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mini-App de Classifica√ß√£o de Associa√ß√µes</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .dark {
            color-scheme: dark;
        }
        .dark body {
            background-color: #111827;
        }
        .dark .bg-white {
            background-color: #1f2937 !important;
        }
        .dark .bg-gray-50 {
            background-color: #374151 !important;
        }
        .dark .bg-gray-100 {
            background-color: #4b5563 !important;
        }
        .dark .text-gray-700 {
            color: #d1d5db !important;
        }
        .dark .text-gray-600 {
            color: #d1d5db !important;
        }
        .dark .text-gray-800 {
            color: #f3f4f6 !important;
        }
        .dark .border-gray-300 {
            border-color: #4b5563 !important;
        }
        .dark .border-gray-200 {
            border-color: #374151 !important;
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-4">

    <div class="w-full max-w-2xl bg-white rounded-xl shadow-lg p-6 md:p-8 space-y-6">
        
        <!-- Cabe√ßalho -->
        <div class="text-center">
            <div class="flex justify-between items-start mb-4">
                <div class="flex-1">
                    <h1 class="text-2xl md:text-3xl font-bold text-gray-800 dark:text-gray-200">Classificador de Associa√ß√µes</h1>
                    <p class="text-gray-500 dark:text-gray-400 mt-1">Selecione um cen√°rio para ver a classifica√ß√£o e pontua√ß√µes.</p>
                </div>
                <button id="theme-toggle" class="p-2 rounded-lg bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 transition-colors duration-200">
                    <span id="theme-icon">üåô</span>
                </button>
                <button id="help-button" class="ml-2 p-2 rounded-lg bg-indigo-100 hover:bg-indigo-200 dark:bg-indigo-800 dark:hover:bg-indigo-700 transition-colors duration-200 text-indigo-600 dark:text-indigo-300 font-bold">
                    ?
                </button>
                <button id="about-button" class="ml-2 p-2 rounded-lg bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 transition-colors duration-200 text-gray-600 dark:text-gray-300 text-sm font-medium">
                    Sobre
                </button>
            </div>
        </div>

        <!-- Controles -->
        <div class="flex flex-col sm:flex-row gap-4">
            <div class="flex-grow">
                <label for="scenario-select" class="block text-sm font-medium text-gray-700 mb-1">Cen√°rio</label>
                <div class="flex gap-2">
                    <select id="scenario-select" class="flex-grow p-3 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition">
                        <!-- Op√ß√µes ser√£o inseridas via JS -->
                    </select>
                    <button id="add-scenario-button" class="px-4 py-3 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors duration-200 font-medium text-sm">
                        + Novo
                    </button>
                </div>
            </div>
            <div class="sm:w-48">
                <label for="type-filter" class="block text-sm font-medium text-gray-700 mb-1">Filtro por Tipo</label>
                <select id="type-filter" class="w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition">
                    <option value="todos">üîç Todos</option>
                    <option value="Associa√ß√£o">üü¢ Associa√ß√µes</option>
                    <option value="Atributo">üîµ Atributos</option>
                </select>
            </div>
        </div>

        <!-- Resultado da Classifica√ß√£o -->
        <div class="text-center">
            <h2 class="text-sm font-medium text-gray-600 mb-2">Classifica√ß√£o Final</h2>
            <div id="classification-display" class="w-full p-4 rounded-lg text-white text-xl font-bold uppercase tracking-wider transition-colors duration-300">
                <!-- Classifica√ß√£o ser√° inserida via JS -->
            </div>
            <div class="mt-3">
                <span class="text-sm text-gray-500">Pontua√ß√£o Total: </span>
                <span id="total-score" class="text-lg font-bold text-indigo-600">0</span>
                <span class="text-sm text-gray-500">/25</span>
                <button id="stats-button" class="ml-4 px-3 py-1 bg-gray-100 hover:bg-gray-200 rounded-full text-xs font-medium text-gray-600 transition-colors duration-200">üìä Stats</button>
            </div>
        </div>

        <!-- Modal de Estat√≠sticas -->
        <div id="stats-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden z-50">
            <div class="bg-white rounded-xl shadow-xl w-full max-w-4xl max-h-[90vh] overflow-y-auto">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-800">üìà Resumo Estat√≠stico</h2>
                        <button id="close-stats" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
                    </div>
                    <div id="stats-content">
                        <!-- Conte√∫do estat√≠stico ser√° inserido via JS -->
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Lista de Crit√©rios e Controles -->
        <div>
            <div class="flex justify-between items-center mb-3">
                <h3 class="text-lg font-semibold text-gray-700">Crit√©rios e Pontua√ß√µes</h3>
                <div class="flex gap-2 flex-wrap">
                    <button id="compare-button" class="px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-all duration-200 text-sm font-medium shadow-sm">‚ö° Comparar</button>
                    <button id="toggle-view-button" class="px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-all duration-200 text-sm font-medium shadow-sm">üìä Gr√°fico</button>
                    <button id="sort-button" class="px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-all duration-200 text-sm font-medium shadow-sm">Ordenar</button>
                    <button id="reset-button" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-all duration-200 text-sm font-medium">Resetar</button>
                </div>
            </div>
            <div id="criteria-list" class="space-y-2">
                <!-- Itens da lista ser√£o inseridos via JS -->
            </div>
            <div id="criteria-chart" class="space-y-3 hidden">
                <!-- Gr√°fico de barras ser√° inserido via JS -->
            </div>
            
            <!-- Hist√≥rico de Consultas -->
            <div id="history-section" class="mt-4 hidden">
                <h4 class="text-sm font-semibold text-gray-600 mb-2">üìã Hist√≥rico Recente</h4>
                <div id="history-list" class="flex flex-wrap gap-2">
                    <!-- Hist√≥rico ser√° inserido via JS -->
                </div>
            </div>
        </div>

        <!-- Modal de Compara√ß√£o -->
        <div id="comparison-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden z-50">
            <div class="bg-white rounded-xl shadow-xl w-full max-w-6xl max-h-[90vh] overflow-y-auto">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-800">üîç Compara√ß√£o de Cen√°rios</h2>
                        <button id="close-comparison" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
                    </div>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Cen√°rio A</label>
                            <select id="compare-scenario-a" class="w-full p-3 border border-gray-300 rounded-lg">
                                <!-- Op√ß√µes preenchidas via JS -->
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Cen√°rio B</label>
                            <select id="compare-scenario-b" class="w-full p-3 border border-gray-300 rounded-lg">
                                <!-- Op√ß√µes preenchidas via JS -->
                            </select>
                        </div>
                    </div>
                    
                    <div id="comparison-content" class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- Conte√∫do da compara√ß√£o ser√° inserido via JS -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal Sobre -->
        <div id="about-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden z-50">
            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-800 dark:text-gray-200">üìö Sobre o Classificador de Associa√ß√µes</h2>
                        <button id="close-about" class="text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 text-2xl">&times;</button>
                    </div>
                    
                    <div class="space-y-6">
                        <!-- Objetivo -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-800 dark:text-gray-200 mb-3">üéØ Objetivo</h3>
                            <p class="text-gray-600 dark:text-gray-300 text-sm leading-relaxed">
                                Ferramenta educacional interativa para ensino dos conceitos fundamentais de 
                                <strong>Associa√ß√£o vs Atributo</strong> em Programa√ß√£o Orientada a Objetos, 
                                permitindo an√°lise visual e comparativa de diferentes cen√°rios atrav√©s de 5 crit√©rios espec√≠ficos.
                            </p>
                        </div>
                        
                        <!-- Cr√©ditos de Desenvolvimento -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-800 dark:text-gray-200 mb-3">üë• Cr√©ditos de Desenvolvimento</h3>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div class="bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg border border-blue-200 dark:border-blue-800">
                                    <h4 class="font-semibold text-blue-800 dark:text-blue-300 mb-3 flex items-center">
                                        üéØ <span class="ml-2">Implementa√ß√£o Inicial (MVP)</span>
                                    </h4>
                                    <div class="space-y-2 text-sm">
                                        <div class="flex items-center">
                                            <span class="w-2 h-2 bg-blue-500 rounded-full mr-2"></span>
                                            <strong>Henrique Moresco</strong>
                                        </div>
                                        <div class="flex items-center">
                                            <span class="w-2 h-2 bg-blue-500 rounded-full mr-2"></span>
                                            <strong>Douglas Ant√¥nio</strong>
                                        </div>
                                        <div class="flex items-center">
                                            <span class="w-2 h-2 bg-blue-500 rounded-full mr-2"></span>
                                            <strong>Kaique Vin√≠cius</strong>
                                        </div>
                                    </div>
                                    <div class="mt-3 p-2 bg-blue-100 dark:bg-blue-800/30 rounded text-xs text-blue-700 dark:text-blue-300">
                                        <strong>Contexto:</strong> Alunos da disciplina de Programa√ß√£o Orientada a Objetos - 2¬∫ Semestre de 2025
                                    </div>
                                    <div class="mt-2 text-xs text-blue-600 dark:text-blue-400">
                                        <strong>Contribui√ß√£o:</strong> Vers√£o MVP conforme especifica√ß√µes do prompt original
                                    </div>
                                </div>
                                
                                <div class="bg-purple-50 dark:bg-purple-900/20 p-4 rounded-lg border border-purple-200 dark:border-purple-800">
                                    <h4 class="font-semibold text-purple-800 dark:text-purple-300 mb-3 flex items-center">
                                        üöÄ <span class="ml-2">Evolu√ß√£o e Melhorias</span>
                                    </h4>
                                    <div class="text-sm">
                                        <div class="flex items-center mb-2">
                                            <span class="w-2 h-2 bg-purple-500 rounded-full mr-2"></span>
                                            <strong>GitHub Copilot (Claude 3.5 Sonnet)</strong>
                                        </div>
                                        <div class="space-y-1 text-xs ml-4">
                                            <div>‚Ä¢ 11 melhorias funcionais implementadas</div>
                                            <div>‚Ä¢ Sistema de onboarding interativo</div>
                                            <div>‚Ä¢ Classifica√ß√£o autom√°tica inteligente</div>
                                            <div>‚Ä¢ Compara√ß√£o side-by-side</div>
                                            <div>‚Ä¢ Gr√°ficos e visualiza√ß√µes</div>
                                            <div>‚Ä¢ Tema escuro/claro</div>
                                            <div>‚Ä¢ Cen√°rios personalizados</div>
                                        </div>
                                    </div>
                                    <div class="mt-3 p-2 bg-purple-100 dark:bg-purple-800/30 rounded text-xs text-purple-700 dark:text-purple-300">
                                        <strong>Contribui√ß√£o:</strong> Expans√£o de MVP simples para plataforma educacional completa
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Evolu√ß√£o -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-800 dark:text-gray-200 mb-3">üìà Evolu√ß√£o da Ferramenta</h3>
                            <div class="text-sm text-gray-600 dark:text-gray-300 space-y-2">
                                <div><strong>Vers√£o Inicial:</strong> Classificador b√°sico com 10 cen√°rios pr√©-definidos</div>
                                <div><strong>Vers√£o Atual:</strong> Plataforma educacional interativa com recursos avan√ßados</div>
                                <div><strong>Impacto:</strong> Transforma√ß√£o de ferramenta t√©cnica em experi√™ncia educacional completa</div>
                            </div>
                        </div>
                        
                        <!-- Tecnologias -->
                        <div>
                            <h3 class="text-lg font-semibold text-gray-800 dark:text-gray-200 mb-3">üõ†Ô∏è Tecnologias</h3>
                            <div class="flex flex-wrap gap-2">
                                <span class="px-2 py-1 bg-orange-100 dark:bg-orange-900/30 text-orange-700 dark:text-orange-300 rounded text-xs">HTML5</span>
                                <span class="px-2 py-1 bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-300 rounded text-xs">JavaScript ES6+</span>
                                <span class="px-2 py-1 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 rounded text-xs">Tailwind CSS</span>
                                <span class="px-2 py-1 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300 rounded text-xs">Responsive Design</span>
                                <span class="px-2 py-1 bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300 rounded text-xs">LocalStorage API</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-6 pt-4 border-t border-gray-200 dark:border-gray-700 text-center">
                        <p class="text-xs text-gray-500 dark:text-gray-400">
                            Desenvolvido como projeto educacional colaborativo ‚Ä¢ 2025
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal de Novo Cen√°rio -->
        <div id="new-scenario-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden z-50">
            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-xl w-full max-w-md">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-xl font-bold text-gray-800 dark:text-gray-200">‚ú® Criar Novo Cen√°rio</h2>
                        <button id="close-new-scenario" class="text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 text-xl">&times;</button>
                    </div>
                    
                    <form id="new-scenario-form" class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Nome do Cen√°rio</label>
                            <input type="text" id="scenario-name" class="w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100" placeholder="Ex: Status do Pedido" required>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Tipo</label>
                            <select id="scenario-type" class="w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100">
                                <option value="">ü§ñ Classifica√ß√£o Autom√°tica</option>
                                <option value="Associa√ß√£o">üü¢ For√ßar Associa√ß√£o</option>
                                <option value="Atributo">üîµ For√ßar Atributo</option>
                            </select>
                            <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">
                                A classifica√ß√£o autom√°tica usa algoritmo baseado nas pontua√ß√µes dos crit√©rios
                            </p>
                        </div>
                        
                        <div class="grid grid-cols-1 gap-3">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Identidade Pr√≥pria (1-5)</label>
                                <input type="number" id="score-1" min="1" max="5" class="w-full p-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Regras Pr√≥prias (1-5)</label>
                                <input type="number" id="score-2" min="1" max="5" class="w-full p-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Ciclo de Vida Independente (1-5)</label>
                                <input type="number" id="score-3" min="1" max="5" class="w-full p-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Varia no Tempo (1-5)</label>
                                <input type="number" id="score-4" min="1" max="5" class="w-full p-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Hist√≥rico (1-5)</label>
                                <input type="number" id="score-5" min="1" max="5" class="w-full p-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100" required>
                            </div>
                        </div>
                        
                        <div class="flex justify-end gap-3 pt-4">
                            <button type="button" id="cancel-new-scenario" class="px-4 py-2 bg-gray-200 hover:bg-gray-300 dark:bg-gray-600 dark:hover:bg-gray-500 rounded-lg transition-colors duration-200">
                                Cancelar
                            </button>
                            <button type="submit" class="px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors duration-200">
                                Criar Cen√°rio
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Sistema de Onboarding -->
        <div id="onboarding-overlay" class="fixed inset-0 bg-black bg-opacity-75 z-[100] hidden">
            <div id="onboarding-spotlight" class="absolute border-4 border-white shadow-2xl transition-all duration-500 pointer-events-none" style="border-radius: 12px;"></div>
            
            <div id="onboarding-tooltip" class="absolute bg-white dark:bg-gray-800 rounded-xl shadow-xl p-6 max-w-sm z-[101] transition-all duration-300">
                <div class="flex items-start justify-between mb-4">
                    <div class="flex items-center">
                        <span id="onboarding-icon" class="text-2xl mr-3">üéØ</span>
                        <h3 id="onboarding-title" class="text-lg font-bold text-gray-800 dark:text-gray-200"></h3>
                    </div>
                    <button id="onboarding-skip" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 text-sm font-medium">Pular</button>
                </div>
                
                <p id="onboarding-description" class="text-gray-600 dark:text-gray-300 text-sm leading-relaxed mb-4"></p>
                
                <div class="flex justify-between items-center">
                    <div class="flex space-x-1">
                        <div id="onboarding-dots" class="flex space-x-1">
                            <!-- Dots ser√£o inseridos via JS -->
                        </div>
                    </div>
                    
                    <div class="flex space-x-2">
                        <button id="onboarding-prev" class="px-3 py-1 text-sm bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 rounded-lg transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed">
                            Anterior
                        </button>
                        <button id="onboarding-next" class="px-3 py-1 text-sm bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition-colors duration-200">
                            Pr√≥ximo
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Se√ß√£o de Cr√©ditos -->
        <div class="mt-6 pt-4 border-t border-gray-200 dark:border-gray-700">
            <div class="text-center">
                <h4 class="text-sm font-semibold text-gray-600 dark:text-gray-400 mb-2">üë• Cr√©ditos</h4>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-3 text-xs text-gray-500 dark:text-gray-400">
                    <div class="bg-blue-50 dark:bg-blue-900/20 p-2 rounded border border-blue-200 dark:border-blue-800">
                        <h5 class="font-semibold text-blue-800 dark:text-blue-300 mb-1 text-xs">üéØ Implementa√ß√£o Inicial (MVP)</h5>
                        <div class="text-xs space-y-0.5">
                            <div><strong>Henrique Moresco</strong> ‚Ä¢ <strong>Douglas Ant√¥nio</strong> ‚Ä¢ <strong>Kaique Vin√≠cius</strong></div>
                        </div>
                        <div class="mt-1 text-blue-600 dark:text-blue-400 font-medium text-xs">
                            Disciplina de POO - 2¬∫ Semestre 2025
                        </div>
                    </div>
                    
                    <div class="bg-purple-50 dark:bg-purple-900/20 p-2 rounded border border-purple-200 dark:border-purple-800">
                        <h5 class="font-semibold text-purple-800 dark:text-purple-300 mb-1 text-xs">üöÄ Evolu√ß√£o e Melhorias Avan√ßadas</h5>
                        <div class="text-purple-600 dark:text-purple-400 text-xs">
                            <div><strong>GitHub Copilot</strong> (Claude 3.5 Sonnet)</div>
                        </div>
                        <div class="mt-1 text-xs">
                            11 melhorias funcionais ‚Ä¢ Sistema de onboarding ‚Ä¢ Classifica√ß√£o autom√°tica ‚Ä¢ Experi√™ncia educacional completa
                        </div>
                    </div>
                </div>
                
                <div class="mt-2 text-xs text-gray-400 dark:text-gray-500">
                    Ferramenta educacional para ensino de conceitos de Programa√ß√£o Orientada a Objetos
                </div>
            </div>
        </div>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- Dados Obrigat√≥rios ---
            const scenariosData = {
                "Cor de Embalagem": { tipo: "Atributo", criterios: { "Identidade Pr√≥pria": 1, "Regras Pr√≥prias": 2, "Ciclo de Vida Independente": 1, "Varia no Tempo": 3, "Hist√≥rico": 1 } },
                "Endere√ßo de Entrega": { tipo: "Associa√ß√£o", criterios: { "Identidade Pr√≥pria": 5, "Regras Pr√≥prias": 5, "Ciclo de Vida Independente": 4, "Varia no Tempo": 4, "Hist√≥rico": 5 } },
                "Estilo de Preparo": { tipo: "Associa√ß√£o", criterios: { "Identidade Pr√≥pria": 4, "Regras Pr√≥prias": 4, "Ciclo de Vida Independente": 3, "Varia no Tempo": 3, "Hist√≥rico": 2 } },
                "Canal de Aquisi√ß√£o": { tipo: "Associa√ß√£o", criterios: { "Identidade Pr√≥pria": 4, "Regras Pr√≥prias": 4, "Ciclo de Vida Independente": 4, "Varia no Tempo": 5, "Hist√≥rico": 5 } },
                "N√≠vel de Risco": { tipo: "Associa√ß√£o", criterios: { "Identidade Pr√≥pria": 3, "Regras Pr√≥prias": 5, "Ciclo de Vida Independente": 4, "Varia no Tempo": 5, "Hist√≥rico": 5 } },
                "Idioma Preferido": { tipo: "Atributo", criterios: { "Identidade Pr√≥pria": 1, "Regras Pr√≥prias": 1, "Ciclo de Vida Independente": 1, "Varia no Tempo": 2, "Hist√≥rico": 1 } },
                "Plano de Manuten√ß√£o": { tipo: "Associa√ß√£o", criterios: { "Identidade Pr√≥pria": 5, "Regras Pr√≥prias": 5, "Ciclo de Vida Independente": 5, "Varia no Tempo": 4, "Hist√≥rico": 5 } },
                "Tipo de Entrega": { tipo: "Atributo", criterios: { "Identidade Pr√≥pria": 1, "Regras Pr√≥prias": 1, "Ciclo de Vida Independente": 1, "Varia no Tempo": 1, "Hist√≥rico": 1 } },
                "Pol√≠tica de Devolu√ß√£o": { tipo: "Associa√ß√£o", criterios: { "Identidade Pr√≥pria": 4, "Regras Pr√≥prias": 5, "Ciclo de Vida Independente": 5, "Varia no Tempo": 4, "Hist√≥rico": 4 } },
                "Certificado de Calibra√ß√£o": { tipo: "Associa√ß√£o", criterios: { "Identidade Pr√≥pria": 5, "Regras Pr√≥prias": 4, "Ciclo de Vida Independente": 5, "Varia no Tempo": 4, "Hist√≥rico": 5 } }
            };
            const originalCriteriaOrder = Object.keys(scenariosData["Endere√ßo de Entrega"].criterios);
            let isChartView = false;
            let visitHistory = [];
            let isDarkMode = false;
            let currentOnboardingStep = 0;
            let isOnboardingActive = false;

            // --- Dados do Tour de Onboarding ---
            const onboardingSteps = [
                {
                    target: 'body',
                    icon: 'üéØ',
                    title: 'Bem-vindo!',
                    description: 'Esta ferramenta ajuda voc√™ a entender a diferen√ßa entre Associa√ß√µes e Atributos em Programa√ß√£o Orientada a Objetos. Vamos fazer um tour r√°pido!',
                    position: 'center'
                },
                {
                    target: '#scenario-select',
                    icon: 'üìã',
                    title: 'Seletor de Cen√°rios',
                    description: 'Aqui voc√™ escolhe qual cen√°rio analisar. Cada cen√°rio representa um elemento que pode ser classificado como Associa√ß√£o ou Atributo.',
                    position: 'bottom'
                },
                {
                    target: '#type-filter',
                    icon: 'üîç',
                    title: 'Filtro por Tipo',
                    description: 'Use este filtro para ver apenas Associa√ß√µes (üü¢), apenas Atributos (üîµ), ou todos os cen√°rios juntos.',
                    position: 'bottom'
                },
                {
                    target: '#classification-display',
                    icon: 'üè∑Ô∏è',
                    title: 'Classifica√ß√£o Final',
                    description: 'Esta √© a classifica√ß√£o do cen√°rio: Verde para Associa√ß√£o (entidade independente) ou Azul para Atributo (caracter√≠stica simples).',
                    position: 'bottom'
                },
                {
                    target: '#total-score',
                    icon: 'üìä',
                    title: 'Pontua√ß√£o Total',
                    description: 'Mostra a soma das pontua√ß√µes nos 5 crit√©rios (m√°ximo 25). Pontua√ß√µes mais altas geralmente indicam Associa√ß√µes.',
                    position: 'bottom'
                },
                {
                    target: '#criteria-list',
                    icon: 'üëë',
                    title: 'Crit√©rios e Destaque',
                    description: 'Lista os 5 crit√©rios com suas pontua√ß√µes. O crit√©rio com maior pontua√ß√£o recebe uma coroa üëë e destaque amarelo.',
                    position: 'top'
                },
                {
                    target: '#compare-button',
                    icon: '‚ö°',
                    title: 'Funcionalidades Avan√ßadas',
                    description: 'Use estes bot√µes para: Comparar cen√°rios lado a lado, alternar para gr√°fico de barras, ordenar por pontua√ß√£o, ou resetar a visualiza√ß√£o.',
                    position: 'top'
                },
                {
                    target: '#stats-button',
                    icon: 'üìà',
                    title: 'Estat√≠sticas e Personaliza√ß√£o',
                    description: 'Acesse estat√≠sticas gerais dos dados, alterne entre tema claro/escuro, e veja seu hist√≥rico de consultas. Agora voc√™ est√° pronto para explorar!',
                    position: 'top'
                }
            ];

            // --- Elementos do DOM ---
            const scenarioSelect = document.getElementById('scenario-select');
            const typeFilter = document.getElementById('type-filter');
            const classificationDisplay = document.getElementById('classification-display');
            const totalScoreDisplay = document.getElementById('total-score');
            const criteriaList = document.getElementById('criteria-list');
            const criteriaChart = document.getElementById('criteria-chart');
            const toggleViewButton = document.getElementById('toggle-view-button');
            const compareButton = document.getElementById('compare-button');
            const sortButton = document.getElementById('sort-button');
            const resetButton = document.getElementById('reset-button');
            const comparisonModal = document.getElementById('comparison-modal');
            const closeComparison = document.getElementById('close-comparison');
            const compareScenarioA = document.getElementById('compare-scenario-a');
            const compareScenarioB = document.getElementById('compare-scenario-b');
            const comparisonContent = document.getElementById('comparison-content');
            const historySection = document.getElementById('history-section');
            const historyList = document.getElementById('history-list');
            const statsButton = document.getElementById('stats-button');
            const statsModal = document.getElementById('stats-modal');
            const closeStats = document.getElementById('close-stats');
            const statsContent = document.getElementById('stats-content');
            const themeToggle = document.getElementById('theme-toggle');
            const themeIcon = document.getElementById('theme-icon');
            const helpButton = document.getElementById('help-button');
            const onboardingOverlay = document.getElementById('onboarding-overlay');
            const onboardingSpotlight = document.getElementById('onboarding-spotlight');
            const onboardingTooltip = document.getElementById('onboarding-tooltip');
            const onboardingIcon = document.getElementById('onboarding-icon');
            const onboardingTitle = document.getElementById('onboarding-title');
            const onboardingDescription = document.getElementById('onboarding-description');
            const onboardingDots = document.getElementById('onboarding-dots');
            const onboardingPrev = document.getElementById('onboarding-prev');
            const onboardingNext = document.getElementById('onboarding-next');
            const onboardingSkip = document.getElementById('onboarding-skip');
            const addScenarioButton = document.getElementById('add-scenario-button');
            const newScenarioModal = document.getElementById('new-scenario-modal');
            const closeNewScenario = document.getElementById('close-new-scenario');
            const cancelNewScenario = document.getElementById('cancel-new-scenario');
            const newScenarioForm = document.getElementById('new-scenario-form');
            const aboutButton = document.getElementById('about-button');
            const aboutModal = document.getElementById('about-modal');
            const closeAbout = document.getElementById('close-about');

            // --- Fun√ß√µes ---

            /**
             * Popula a lista de crit√©rios na tela.
             * @param {string[]} criteriaOrder - A ordem dos nomes dos crit√©rios a serem exibidos.
             * @param {Object} criteriaScores - O objeto com as pontua√ß√µes dos crit√©rios.
             */
            function renderCriteria(criteriaOrder, criteriaScores) {
                criteriaList.innerHTML = ''; // Limpa a lista atual
                
                // Encontra a maior pontua√ß√£o para destacar
                const maxScore = Math.max(...Object.values(criteriaScores));
                
                criteriaOrder.forEach(key => {
                    const score = criteriaScores[key];
                    const isHighest = score === maxScore;
                    const item = document.createElement('div');
                    item.className = `flex justify-between items-center p-3 rounded-lg border transition-all duration-200 ${
                        isHighest ? 'bg-yellow-50 border-yellow-300 shadow-sm' : 'bg-gray-50 border-gray-200'
                    }`;
                    
                    const nameSpan = document.createElement('span');
                    nameSpan.className = `text-gray-700 ${isHighest ? 'font-semibold' : ''}`;
                    nameSpan.textContent = key;
                    if (isHighest) {
                        const crown = document.createElement('span');
                        crown.textContent = ' üëë';
                        nameSpan.appendChild(crown);
                    }

                    const scoreSpan = document.createElement('span');
                    scoreSpan.className = `font-bold text-lg ${isHighest ? 'text-yellow-600' : 'text-indigo-600'}`;
                    scoreSpan.textContent = score;

                    item.appendChild(nameSpan);
                    item.appendChild(scoreSpan);
                    criteriaList.appendChild(item);
                });
            }

            /**
             * Renderiza um gr√°fico de barras horizontais dos crit√©rios.
             * @param {string[]} criteriaOrder - A ordem dos nomes dos crit√©rios.
             * @param {Object} criteriaScores - O objeto com as pontua√ß√µes dos crit√©rios.
             */
            function renderChart(criteriaOrder, criteriaScores) {
                criteriaChart.innerHTML = '';
                const maxScore = Math.max(...Object.values(criteriaScores));
                
                criteriaOrder.forEach(key => {
                    const score = criteriaScores[key];
                    const percentage = (score / 5) * 100; // M√°ximo √© 5
                    const isHighest = score === maxScore;
                    
                    const container = document.createElement('div');
                    container.className = 'space-y-1';
                    
                    const labelRow = document.createElement('div');
                    labelRow.className = 'flex justify-between items-center';
                    
                    const label = document.createElement('span');
                    label.className = `text-sm ${isHighest ? 'font-semibold text-yellow-700' : 'text-gray-700'}`;
                    label.textContent = key + (isHighest ? ' üëë' : '');
                    
                    const scoreLabel = document.createElement('span');
                    scoreLabel.className = `text-sm font-bold ${isHighest ? 'text-yellow-600' : 'text-indigo-600'}`;
                    scoreLabel.textContent = score;
                    
                    labelRow.appendChild(label);
                    labelRow.appendChild(scoreLabel);
                    
                    const barContainer = document.createElement('div');
                    barContainer.className = 'w-full bg-gray-200 rounded-full h-3';
                    
                    const bar = document.createElement('div');
                    bar.className = `h-3 rounded-full transition-all duration-500 ${
                        isHighest ? 'bg-gradient-to-r from-yellow-400 to-yellow-600' : 'bg-gradient-to-r from-indigo-400 to-indigo-600'
                    }`;
                    bar.style.width = `${percentage}%`;
                    
                    barContainer.appendChild(bar);
                    container.appendChild(labelRow);
                    container.appendChild(barContainer);
                    criteriaChart.appendChild(container);
                });
            }

            /**
             * Alterna entre visualiza√ß√£o de lista e gr√°fico.
             */
            function toggleView() {
                isChartView = !isChartView;
                if (isChartView) {
                    criteriaList.classList.add('hidden');
                    criteriaChart.classList.remove('hidden');
                    toggleViewButton.textContent = 'üìã Lista';
                } else {
                    criteriaList.classList.remove('hidden');
                    criteriaChart.classList.add('hidden');
                    toggleViewButton.textContent = 'üìä Gr√°fico';
                }
                
                // Re-renderiza o conte√∫do atual
                const selectedScenarioName = scenarioSelect.value;
                const scenario = scenariosData[selectedScenarioName];
                if (scenario) {
                    if (isChartView) {
                        const currentOrder = sortButton.dataset.sorted === 'true' ? 
                            Object.entries(scenario.criterios).sort(([, scoreA], [, scoreB]) => scoreB - scoreA).map(([name]) => name) :
                            originalCriteriaOrder;
                        renderChart(currentOrder, scenario.criterios);
                    } else {
                        const currentOrder = sortButton.dataset.sorted === 'true' ? 
                            Object.entries(scenario.criterios).sort(([, scoreA], [, scoreB]) => scoreB - scoreA).map(([name]) => name) :
                            originalCriteriaOrder;
                        renderCriteria(currentOrder, scenario.criterios);
                    }
                }
            }

            /**
             * Abre o modal de compara√ß√£o.
             */
            function openComparison() {
                // Popula os selects de compara√ß√£o
                [compareScenarioA, compareScenarioB].forEach(select => {
                    select.innerHTML = '';
                    Object.entries(scenariosData).forEach(([name, data]) => {
                        const option = document.createElement('option');
                        option.value = name;
                        option.textContent = `${data.tipo === 'Associa√ß√£o' ? 'üü¢' : 'üîµ'} ${name}`;
                        select.appendChild(option);
                    });
                });
                
                // Define valores padr√£o
                const scenarios = Object.keys(scenariosData);
                compareScenarioA.value = scenarios[0];
                compareScenarioB.value = scenarios[1];
                
                updateComparison();
                comparisonModal.classList.remove('hidden');
            }

            /**
             * Atualiza o conte√∫do da compara√ß√£o.
             */
            function updateComparison() {
                const scenarioA = scenariosData[compareScenarioA.value];
                const scenarioB = scenariosData[compareScenarioB.value];
                
                if (!scenarioA || !scenarioB) return;
                
                const totalA = Object.values(scenarioA.criterios).reduce((sum, score) => sum + score, 0);
                const totalB = Object.values(scenarioB.criterios).reduce((sum, score) => sum + score, 0);
                
                comparisonContent.innerHTML = `
                    <div class="bg-gray-50 p-6 rounded-lg">
                        <h3 class="text-lg font-bold mb-4">${compareScenarioA.value}</h3>
                        <div class="text-center mb-4">
                            <div class="p-3 rounded-lg text-white font-bold ${scenarioA.tipo === 'Associa√ß√£o' ? 'bg-green-600' : 'bg-blue-500'}">
                                ${scenarioA.tipo.toUpperCase()}
                            </div>
                            <div class="mt-2 text-sm text-gray-600">
                                Total: <span class="font-bold text-lg text-indigo-600">${totalA}</span>/25
                            </div>
                        </div>
                        <div class="space-y-2">
                            ${Object.entries(scenarioA.criterios).map(([key, score]) => `
                                <div class="flex justify-between items-center p-2 rounded ${score === Math.max(...Object.values(scenarioA.criterios)) ? 'bg-yellow-100' : 'bg-white'}">
                                    <span class="text-sm">${key}</span>
                                    <span class="font-bold ${score === Math.max(...Object.values(scenarioA.criterios)) ? 'text-yellow-600' : 'text-indigo-600'}">${score}</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    
                    <div class="bg-gray-50 p-6 rounded-lg">
                        <h3 class="text-lg font-bold mb-4">${compareScenarioB.value}</h3>
                        <div class="text-center mb-4">
                            <div class="p-3 rounded-lg text-white font-bold ${scenarioB.tipo === 'Associa√ß√£o' ? 'bg-green-600' : 'bg-blue-500'}">
                                ${scenarioB.tipo.toUpperCase()}
                            </div>
                            <div class="mt-2 text-sm text-gray-600">
                                Total: <span class="font-bold text-lg text-indigo-600">${totalB}</span>/25
                            </div>
                        </div>
                        <div class="space-y-2">
                            ${Object.entries(scenarioB.criterios).map(([key, score]) => `
                                <div class="flex justify-between items-center p-2 rounded ${score === Math.max(...Object.values(scenarioB.criterios)) ? 'bg-yellow-100' : 'bg-white'}">
                                    <span class="text-sm">${key}</span>
                                    <span class="font-bold ${score === Math.max(...Object.values(scenarioB.criterios)) ? 'text-yellow-600' : 'text-indigo-600'}">${score}</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }

            /**
             * Atualiza toda a interface com base no cen√°rio selecionado.
             * @param {string} scenarioName - O nome do cen√°rio a ser exibido.
             */
            function updateDisplay(scenarioName) {
                const scenario = scenariosData[scenarioName];
                if (!scenario) return;

                // Atualiza o display de classifica√ß√£o
                classificationDisplay.textContent = scenario.tipo;
                if (scenario.tipo === 'Associa√ß√£o') {
                    classificationDisplay.classList.remove('bg-blue-500');
                    classificationDisplay.classList.add('bg-green-600');
                } else {
                    classificationDisplay.classList.remove('bg-green-600');
                    classificationDisplay.classList.add('bg-blue-500');
                }

                // Calcula e exibe a pontua√ß√£o total
                const totalScore = Object.values(scenario.criterios).reduce((sum, score) => sum + score, 0);
                totalScoreDisplay.textContent = totalScore;

                // Renderiza a lista de crit√©rios na ordem original
                if (isChartView) {
                    renderChart(originalCriteriaOrder, scenario.criterios);
                } else {
                    renderCriteria(originalCriteriaOrder, scenario.criterios);
                }
                
                // Reset do estado de ordena√ß√£o
                sortButton.dataset.sorted = 'false';
                
                // Adiciona ao hist√≥rico
                addToHistory(scenarioName);
            }

            /**
             * Adiciona um cen√°rio ao hist√≥rico de visitas.
             * @param {string} scenarioName - Nome do cen√°rio visitado.
             */
            function addToHistory(scenarioName) {
                // Remove se j√° existe para mover para o topo
                visitHistory = visitHistory.filter(item => item !== scenarioName);
                // Adiciona no in√≠cio
                visitHistory.unshift(scenarioName);
                // Mant√©m apenas os √∫ltimos 5
                visitHistory = visitHistory.slice(0, 5);
                
                updateHistoryDisplay();
            }

            /**
             * Atualiza a exibi√ß√£o do hist√≥rico.
             */
            function updateHistoryDisplay() {
                if (visitHistory.length === 0) {
                    historySection.classList.add('hidden');
                    return;
                }
                
                historySection.classList.remove('hidden');
                historyList.innerHTML = '';
                
                visitHistory.forEach(scenarioName => {
                    const scenario = scenariosData[scenarioName];
                    if (!scenario) return;
                    
                    const button = document.createElement('button');
                    button.className = 'px-3 py-1 bg-gray-100 hover:bg-gray-200 rounded-full text-xs font-medium text-gray-700 transition-colors duration-200';
                    button.textContent = `${scenario.tipo === 'Associa√ß√£o' ? 'üü¢' : 'üîµ'} ${scenarioName}`;
                    button.addEventListener('click', () => {
                        scenarioSelect.value = scenarioName;
                        updateDisplay(scenarioName);
                    });
                    
                    historyList.appendChild(button);
                });
            }

            /**
             * Abre o modal de estat√≠sticas.
             */
            function openStats() {
                const associacoes = Object.entries(scenariosData).filter(([, data]) => data.tipo === 'Associa√ß√£o');
                const atributos = Object.entries(scenariosData).filter(([, data]) => data.tipo === 'Atributo');
                
                // Calcula m√©dias por crit√©rio
                const criteriaAverages = {};
                originalCriteriaOrder.forEach(criterio => {
                    const scores = Object.values(scenariosData).map(scenario => scenario.criterios[criterio]);
                    criteriaAverages[criterio] = (scores.reduce((sum, score) => sum + score, 0) / scores.length).toFixed(1);
                });
                
                // Cen√°rio com maior e menor pontua√ß√£o total
                const totals = Object.entries(scenariosData).map(([name, data]) => ({
                    name,
                    total: Object.values(data.criterios).reduce((sum, score) => sum + score, 0),
                    tipo: data.tipo
                }));
                
                const highest = totals.reduce((max, item) => item.total > max.total ? item : max);
                const lowest = totals.reduce((min, item) => item.total < min.total ? item : min);
                
                statsContent.innerHTML = `
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-6">
                        <div class="bg-green-50 p-4 rounded-lg border-l-4 border-green-500">
                            <h3 class="font-semibold text-green-800 mb-2">üü¢ Associa√ß√µes</h3>
                            <div class="text-2xl font-bold text-green-600">${associacoes.length}</div>
                            <div class="text-sm text-green-700">${((associacoes.length / Object.keys(scenariosData).length) * 100).toFixed(0)}% do total</div>
                        </div>
                        
                        <div class="bg-blue-50 p-4 rounded-lg border-l-4 border-blue-500">
                            <h3 class="font-semibold text-blue-800 mb-2">üîµ Atributos</h3>
                            <div class="text-2xl font-bold text-blue-600">${atributos.length}</div>
                            <div class="text-sm text-blue-700">${((atributos.length / Object.keys(scenariosData).length) * 100).toFixed(0)}% do total</div>
                        </div>
                        
                        <div class="bg-purple-50 p-4 rounded-lg border-l-4 border-purple-500">
                            <h3 class="font-semibold text-purple-800 mb-2">üìä Total Cen√°rios</h3>
                            <div class="text-2xl font-bold text-purple-600">${Object.keys(scenariosData).length}</div>
                            <div class="text-sm text-purple-700">Dispon√≠veis para an√°lise</div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                        <div class="bg-yellow-50 p-4 rounded-lg">
                            <h3 class="font-semibold text-yellow-800 mb-3">üèÜ Maior Pontua√ß√£o</h3>
                            <div class="flex items-center justify-between">
                                <span class="font-medium">${highest.name}</span>
                                <span class="px-2 py-1 rounded text-sm ${highest.tipo === 'Associa√ß√£o' ? 'bg-green-100 text-green-800' : 'bg-blue-100 text-blue-800'}">${highest.tipo}</span>
                            </div>
                            <div class="text-2xl font-bold text-yellow-600 mt-2">${highest.total}/25</div>
                        </div>
                        
                        <div class="bg-gray-50 p-4 rounded-lg">
                            <h3 class="font-semibold text-gray-800 mb-3">üìâ Menor Pontua√ß√£o</h3>
                            <div class="flex items-center justify-between">
                                <span class="font-medium">${lowest.name}</span>
                                <span class="px-2 py-1 rounded text-sm ${lowest.tipo === 'Associa√ß√£o' ? 'bg-green-100 text-green-800' : 'bg-blue-100 text-blue-800'}">${lowest.tipo}</span>
                            </div>
                            <div class="text-2xl font-bold text-gray-600 mt-2">${lowest.total}/25</div>
                        </div>
                    </div>
                    
                    <div class="bg-indigo-50 p-4 rounded-lg">
                        <h3 class="font-semibold text-indigo-800 mb-3">üìà M√©dias por Crit√©rio</h3>
                        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                            ${Object.entries(criteriaAverages).map(([criterio, media]) => `
                                <div class="bg-white p-3 rounded border">
                                    <div class="text-sm text-gray-600">${criterio}</div>
                                    <div class="text-lg font-bold text-indigo-600">${media}</div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
                
                statsModal.classList.remove('hidden');
            }

            /**
             * Alterna entre tema claro e escuro.
             */
            function toggleTheme() {
                isDarkMode = !isDarkMode;
                document.documentElement.classList.toggle('dark', isDarkMode);
                themeIcon.textContent = isDarkMode ? '‚òÄÔ∏è' : 'üåô';
                localStorage.setItem('darkMode', isDarkMode);
            }

            /**
             * Carrega a prefer√™ncia de tema salva.
             */
            function loadTheme() {
                const savedTheme = localStorage.getItem('darkMode');
                if (savedTheme !== null) {
                    isDarkMode = savedTheme === 'true';
                    document.documentElement.classList.toggle('dark', isDarkMode);
                    themeIcon.textContent = isDarkMode ? '‚òÄÔ∏è' : 'üåô';
                }
            }

            /**
             * Inicia o tour de onboarding.
             */
            function startOnboarding() {
                isOnboardingActive = true;
                currentOnboardingStep = 0;
                onboardingOverlay.classList.remove('hidden');
                createOnboardingDots();
                showOnboardingStep();
            }

            /**
             * Finaliza o tour de onboarding.
             */
            function endOnboarding() {
                isOnboardingActive = false;
                onboardingOverlay.classList.add('hidden');
                localStorage.setItem('onboardingCompleted', 'true');
            }

            /**
             * Cria os dots indicadores de progresso.
             */
            function createOnboardingDots() {
                onboardingDots.innerHTML = '';
                onboardingSteps.forEach((_, index) => {
                    const dot = document.createElement('div');
                    dot.className = `w-2 h-2 rounded-full transition-colors duration-200 ${
                        index === currentOnboardingStep ? 'bg-indigo-600' : 'bg-gray-300'
                    }`;
                    onboardingDots.appendChild(dot);
                });
            }

            /**
             * Mostra o passo atual do onboarding.
             */
            function showOnboardingStep() {
                const step = onboardingSteps[currentOnboardingStep];
                if (!step) return;

                // Atualiza conte√∫do do tooltip
                onboardingIcon.textContent = step.icon;
                onboardingTitle.textContent = step.title;
                onboardingDescription.textContent = step.description;

                // Atualiza dots
                createOnboardingDots();

                // Atualiza bot√µes
                onboardingPrev.disabled = currentOnboardingStep === 0;
                onboardingNext.textContent = currentOnboardingStep === onboardingSteps.length - 1 ? 'Finalizar' : 'Pr√≥ximo';

                // Aguarda um frame para garantir que elementos est√£o renderizados
                requestAnimationFrame(() => {
                    // Posiciona spotlight e tooltip
                    if (step.target === 'body') {
                        // Caso especial para boas-vindas - centraliza
                        onboardingSpotlight.style.display = 'none';
                        onboardingTooltip.style.top = '50%';
                        onboardingTooltip.style.left = '50%';
                        onboardingTooltip.style.transform = 'translate(-50%, -50%)';
                    } else {
                        // Posiciona baseado no elemento alvo
                        const targetElement = document.querySelector(step.target);
                        if (targetElement) {
                            // For√ßa o elemento a ficar vis√≠vel primeiro
                            targetElement.scrollIntoView({ 
                                behavior: 'smooth', 
                                block: 'center',
                                inline: 'center'
                            });

                            // Aguarda o scroll completar
                            setTimeout(() => {
                                const rect = targetElement.getBoundingClientRect();
                                
                                // Configura spotlight - posi√ß√£o fixa relativa √† viewport
                                onboardingSpotlight.style.display = 'block';
                                onboardingSpotlight.style.width = `${rect.width + 20}px`;
                                onboardingSpotlight.style.height = `${rect.height + 20}px`;
                                onboardingSpotlight.style.left = `${rect.left - 10}px`;
                                onboardingSpotlight.style.top = `${rect.top - 10}px`;

                                // Posiciona tooltip
                                let tooltipTop, tooltipLeft, transform;
                                const tooltipWidth = 320; // largura estimada do tooltip
                                const tooltipHeight = 200; // altura estimada do tooltip
                                
                                if (step.position === 'bottom') {
                                    tooltipTop = rect.bottom + 20;
                                    tooltipLeft = rect.left + (rect.width / 2);
                                    transform = 'translateX(-50%)';
                                    
                                    // Verifica se vai sair da tela na parte inferior
                                    if (tooltipTop + tooltipHeight > window.innerHeight) {
                                        tooltipTop = rect.top - tooltipHeight - 20;
                                        transform = 'translateX(-50%)';
                                    }
                                } else if (step.position === 'top') {
                                    tooltipTop = rect.top - tooltipHeight - 20;
                                    tooltipLeft = rect.left + (rect.width / 2);
                                    transform = 'translateX(-50%)';
                                    
                                    // Verifica se vai sair da tela na parte superior
                                    if (tooltipTop < 0) {
                                        tooltipTop = rect.bottom + 20;
                                        transform = 'translateX(-50%)';
                                    }
                                } else {
                                    tooltipTop = rect.top + (rect.height / 2);
                                    tooltipLeft = rect.right + 20;
                                    transform = 'translateY(-50%)';
                                    
                                    // Verifica se vai sair da tela na lateral direita
                                    if (tooltipLeft + tooltipWidth > window.innerWidth) {
                                        tooltipLeft = rect.left - tooltipWidth - 20;
                                        transform = 'translateY(-50%)';
                                    }
                                }

                                // Garante que tooltip n√£o saia da tela
                                if (tooltipLeft < 10) tooltipLeft = 10;
                                if (tooltipLeft + tooltipWidth > window.innerWidth - 10) {
                                    tooltipLeft = window.innerWidth - tooltipWidth - 10;
                                }
                                if (tooltipTop < 10) tooltipTop = 10;

                                onboardingTooltip.style.top = `${tooltipTop}px`;
                                onboardingTooltip.style.left = `${tooltipLeft}px`;
                                onboardingTooltip.style.transform = transform;
                            }, 300); // delay para o scroll completar
                        }
                    }
                });
            }

            /**
             * Avan√ßa para o pr√≥ximo passo do onboarding.
             */
            function nextOnboardingStep() {
                if (currentOnboardingStep < onboardingSteps.length - 1) {
                    currentOnboardingStep++;
                    showOnboardingStep();
                } else {
                    endOnboarding();
                }
            }

            /**
             * Volta para o passo anterior do onboarding.
             */
            function prevOnboardingStep() {
                if (currentOnboardingStep > 0) {
                    currentOnboardingStep--;
                    showOnboardingStep();
                }
            }

            /**
             * Verifica se deve mostrar o onboarding automaticamente.
             */
            function checkAutoOnboarding() {
                const completed = localStorage.getItem('onboardingCompleted');
                if (!completed) {
                    // Delay para garantir que a p√°gina carregou completamente
                    setTimeout(startOnboarding, 1000);
                }
            }

            /**
             * Abre o modal de cria√ß√£o de novo cen√°rio.
             */
            function openNewScenarioModal() {
                newScenarioModal.classList.remove('hidden');
            }

            /**
             * Fecha o modal de cria√ß√£o de novo cen√°rio.
             */
            function closeNewScenarioModal() {
                newScenarioModal.classList.add('hidden');
                newScenarioForm.reset();
            }

            /**
             * Adiciona um novo cen√°rio personalizado.
             */
            function addCustomScenario(formData) {
                const name = formData.get('name');
                let type = formData.get('type');
                const scores = {
                    "Identidade Pr√≥pria": parseInt(formData.get('score-1')),
                    "Regras Pr√≥prias": parseInt(formData.get('score-2')),
                    "Ciclo de Vida Independente": parseInt(formData.get('score-3')),
                    "Varia no Tempo": parseInt(formData.get('score-4')),
                    "Hist√≥rico": parseInt(formData.get('score-5'))
                };

                // Se tipo n√£o foi especificado, usa classifica√ß√£o autom√°tica
                if (!type) {
                    type = autoClassifyScenario(scores);
                }

                // Adiciona ao objeto de dados
                scenariosData[name] = {
                    tipo: type,
                    criterios: scores,
                    custom: true,
                    autoClassified: !formData.get('type') // marca se foi classificado automaticamente
                };

                // Salva cen√°rios customizados no localStorage
                saveCustomScenarios();

                // Atualiza a interface
                populateSelect(typeFilter.value);
                scenarioSelect.value = name;
                updateDisplay(name);
                
                closeNewScenarioModal();
            }

            /**
             * Salva cen√°rios customizados no localStorage.
             */
            function saveCustomScenarios() {
                const customScenarios = {};
                Object.entries(scenariosData).forEach(([name, data]) => {
                    if (data.custom) {
                        customScenarios[name] = data;
                    }
                });
                localStorage.setItem('customScenarios', JSON.stringify(customScenarios));
            }

            /**
             * Carrega cen√°rios customizados do localStorage.
             */
            function loadCustomScenarios() {
                const saved = localStorage.getItem('customScenarios');
                if (saved) {
                    const customScenarios = JSON.parse(saved);
                    Object.assign(scenariosData, customScenarios);
                }
            }

            /**
             * Classifica automaticamente um cen√°rio baseado nas pontua√ß√µes.
             * Algoritmo: Associa√ß√£o se pontua√ß√£o total >= 15 OU se 3+ crit√©rios >= 4
             * @param {Object} scores - Pontua√ß√µes dos crit√©rios
             * @returns {string} - "Associa√ß√£o" ou "Atributo"
             */
            function autoClassifyScenario(scores) {
                const scoresArray = Object.values(scores);
                const total = scoresArray.reduce((sum, score) => sum + score, 0);
                const highScores = scoresArray.filter(score => score >= 4).length;
                
                // Algoritmo de classifica√ß√£o baseado nos dados de treinamento
                if (total >= 15 || highScores >= 3) {
                    return "Associa√ß√£o";
                } else {
                    return "Atributo";
                }
            }

            /**
             * Popula o menu dropdown com os cen√°rios.
             * @param {string} filterType - Tipo para filtrar ("todos", "Associa√ß√£o", "Atributo")
             */
            function populateSelect(filterType = 'todos') {
                scenarioSelect.innerHTML = '';
                const filteredScenarios = Object.entries(scenariosData).filter(([name, data]) => {
                    return filterType === 'todos' || data.tipo === filterType;
                });
                
                filteredScenarios.forEach(([name, data]) => {
                    const option = document.createElement('option');
                    option.value = name;
                    const prefix = data.tipo === 'Associa√ß√£o' ? 'üü¢' : 'üîµ';
                    const customIndicator = data.custom ? ' ‚ú®' : '';
                    const autoIndicator = data.autoClassified ? ' ü§ñ' : '';
                    option.textContent = `${prefix} ${name}${customIndicator}${autoIndicator}`;
                    scenarioSelect.appendChild(option);
                });
                
                // Se h√° cen√°rios dispon√≠veis, seleciona o primeiro
                if (filteredScenarios.length > 0) {
                    updateDisplay(filteredScenarios[0][0]);
                }
            }

            // --- Event Listeners ---
            scenarioSelect.addEventListener('change', (e) => {
                updateDisplay(e.target.value);
            });

            typeFilter.addEventListener('change', (e) => {
                populateSelect(e.target.value);
            });

            toggleViewButton.addEventListener('click', toggleView);

            compareButton.addEventListener('click', openComparison);

            closeComparison.addEventListener('click', () => {
                comparisonModal.classList.add('hidden');
            });

            compareScenarioA.addEventListener('change', updateComparison);
            compareScenarioB.addEventListener('change', updateComparison);

            // Fechar modal clicando fora
            comparisonModal.addEventListener('click', (e) => {
                if (e.target === comparisonModal) {
                    comparisonModal.classList.add('hidden');
                }
            });

            statsButton.addEventListener('click', openStats);

            closeStats.addEventListener('click', () => {
                statsModal.classList.add('hidden');
            });

            // Fechar modal de stats clicando fora
            statsModal.addEventListener('click', (e) => {
                if (e.target === statsModal) {
                    statsModal.classList.add('hidden');
                }
            });

            themeToggle.addEventListener('click', toggleTheme);

            helpButton.addEventListener('click', startOnboarding);

            onboardingNext.addEventListener('click', nextOnboardingStep);
            onboardingPrev.addEventListener('click', prevOnboardingStep);
            onboardingSkip.addEventListener('click', endOnboarding);

            // Fechar onboarding com ESC
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && isOnboardingActive) {
                    endOnboarding();
                }
            });

            // Reposicionar onboarding ao redimensionar janela
            window.addEventListener('resize', () => {
                if (isOnboardingActive) {
                    showOnboardingStep();
                }
            });

            addScenarioButton.addEventListener('click', openNewScenarioModal);
            closeNewScenario.addEventListener('click', closeNewScenarioModal);
            cancelNewScenario.addEventListener('click', closeNewScenarioModal);

            aboutButton.addEventListener('click', () => {
                aboutModal.classList.remove('hidden');
            });

            closeAbout.addEventListener('click', () => {
                aboutModal.classList.add('hidden');
            });

            // Fechar modais clicando fora
            newScenarioModal.addEventListener('click', (e) => {
                if (e.target === newScenarioModal) {
                    closeNewScenarioModal();
                }
            });

            aboutModal.addEventListener('click', (e) => {
                if (e.target === aboutModal) {
                    aboutModal.classList.add('hidden');
                }
            });

            newScenarioForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const formData = new FormData(e.target);
                
                // Adiciona os campos manualmente pois os nomes s√£o diferentes
                formData.set('name', document.getElementById('scenario-name').value);
                formData.set('type', document.getElementById('scenario-type').value);
                formData.set('score-1', document.getElementById('score-1').value);
                formData.set('score-2', document.getElementById('score-2').value);
                formData.set('score-3', document.getElementById('score-3').value);
                formData.set('score-4', document.getElementById('score-4').value);
                formData.set('score-5', document.getElementById('score-5').value);
                
                addCustomScenario(formData);
            });            sortButton.addEventListener('click', () => {
                const selectedScenarioName = scenarioSelect.value;
                const scenario = scenariosData[selectedScenarioName];
                if (!scenario) return;

                const sortedCriteria = Object.entries(scenario.criterios)
                    .sort(([, scoreA], [, scoreB]) => scoreB - scoreA)
                    .map(([name]) => name);
                
                if (isChartView) {
                    renderChart(sortedCriteria, scenario.criterios);
                } else {
                    renderCriteria(sortedCriteria, scenario.criterios);
                }
                
                sortButton.dataset.sorted = 'true';
            });

            resetButton.addEventListener('click', () => {
                updateDisplay(scenarioSelect.value);
            });

            // --- Inicializa√ß√£o ---
            function init() {
                loadTheme();
                loadCustomScenarios();
                populateSelect('todos');
                const initialState = 'Endere√ßo de Entrega';
                scenarioSelect.value = initialState;
                updateDisplay(initialState);
                checkAutoOnboarding();
            }

            init();
        });
    </script>
</body>
</html>
